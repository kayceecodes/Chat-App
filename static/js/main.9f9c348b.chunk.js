(this["webpackJsonpslack-app"]=this["webpackJsonpslack-app"]||[]).push([[0],{135:function(e,t,a){e.exports={register:"Login_register__wvTPC",formContainer:"Login_formContainer__3HE1b",loginHeader:"Login_loginHeader__2NNDs",uiMessage:"Login_uiMessage__lv14g"}},136:function(e,t,a){e.exports={register:"Register_register__2ETAL",formContainer:"Register_formContainer__1IEIQ",loginHeader:"Register_loginHeader__aDF43",uiMessage:"Register_uiMessage__2wtzw"}},275:function(e,t,a){e.exports={slidePanelContainer:"SidePanel_slidePanelContainer__FGWzq"}},276:function(e,t,a){e.exports={metaPanel:"MetaPanel_metaPanel__1_bR8"}},278:function(e,t,a){},281:function(e,t,a){e.exports={messageForm:"MessageForm_messageForm__rfMWm"}},283:function(e,t,a){e.exports={messages:"Messages_messages__3AdIW",comment:"Messages_comment__2_ekb"}},296:function(e,t,a){e.exports=a(533)},517:function(e,t,a){},533:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a(24),s=a(21),l=a(20),o=a(22),c=a(0),i=a.n(c),u=a(74),d=a.n(u);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var h=a(554),m=a(559),p=a(553),f=a(542),g=a(534),v=a(547),E=a(556),C=a(102),b=a(56),y=a(168),S=a(127),O=a.n(S),j=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),t}(i.a.Component),k=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={modal:!1,primary:"",secondary:"",user:a.props.currentUser,usersRef:O.a.database().ref("users")},a.handleChangePrimary=function(e){return a.setState({primary:e.hex})},a.handleChangeSecondary=function(e){return a.setState({secondary:e.hex})},a.handleSaveColors=function(){a.state.primary&&a.state.secondary&&a.saveColors(a.state.primary,a.state.secondary)},a.saveColors=function(e,t){a.state.usersRef.child("".concat(a.state.user.uid,"/colors")).push().update({primary:e,secondary:t}).then((function(){console.log("Colors added")})).catch((function(e){return console.log(e)}))},a.openModal=function(){return a.setState({modal:!0})},a.closeModal=function(){return a.setState({modal:!1})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=(e.modal,e.primary),a=e.secondary;return i.a.createElement(m.a,{as:p.a,inverted:!0,vertical:!0,visible:!0,width:"very thin"},i.a.createElement(f.a,null),i.a.createElement(g.a,{icon:"add",size:"small",style:{backgroundColor:"#00ada5"},onClick:this.openModal}),i.a.createElement(v.a,{basic:!0,open:this.state.modal,onClose:this.closeModal},i.a.createElement(v.a.Header,null,i.a.createElement(v.a.Content,null,i.a.createElement(E.a,{inverted:!0,onClick:this.handleSaveColors},i.a.createElement(C.a,{content:"Primary Color"}),i.a.createElement(y.SliderPicker,{color:t,onChange:this.handleChangePrimary})),i.a.createElement(E.a,{inverted:!0,onClick:this.handleSaveColors},i.a.createElement(C.a,{content:"Secondary Color"}),i.a.createElement(y.SliderPicker,{color:a,onChange:this.handleChangeSecondary}))),i.a.createElement(v.a.Actions,null,i.a.createElement(g.a,{color:"green",inverted:!0},i.a.createElement(b.a,{name:"checkmark"})," Apply Colors"),i.a.createElement(g.a,{color:"red",onClick:this.closeModal,inverted:!0},i.a.createElement(b.a,{name:"remove"})," Cancel")))))}}]),t}(j),U=a(555),M=a(550),R=a(287),w=a(33),_=a(171),P=a.n(_);a(514),a(515),a(516);P.a.initializeApp({apiKey:"AIzaSyAuyuNcunURGGkny2xJ0VDcXOc5k2kohcg",authDomain:"slack-app-d47b6.firebaseapp.com",databaseURL:"https://slack-app-d47b6.firebaseio.com",projectId:"slack-app-d47b6",storageBucket:"slack-app-d47b6.appspot.com",messagingSenderId:"539859022252"});var N=P.a,A=(a(517),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={user:a.props.currentUser},a.dropdownOptions=function(){return[{key:"user",text:i.a.createElement("span",null," ","Signed in as",i.a.createElement("strong",null,a.props.currentUser.displayName)),disabled:!0},{key:"avatar",text:i.a.createElement("span",null,"Change Avatar")},{key:"signout",text:i.a.createElement("span",{onClick:a.handleSignout},"Sign Out")}]},a.handleSignout=function(){N.auth().signOut().then((function(){return console.log("signed out!")}))},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.setState({user:this.props.currentUser})}},{key:"render",value:function(){console.log(this.props.currentUser);var e=this.state.user;return i.a.createElement(h.a,null,i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Row,{style:{padding:"1.2em",margin:0}},i.a.createElement(U.a,{inverted:!0,floated:"left",as:"h2"},i.a.createElement(b.a,{name:"code"}),i.a.createElement(U.a.Content,null,"DevChat")),i.a.createElement(U.a,{style:{padding:"0.25em"},as:"h4",inverted:!0}),i.a.createElement(M.a,{trigger:i.a.createElement("span",{style:{color:"white"}},i.a.createElement("br",null),i.a.createElement(R.a,{space:"right",avatar:!0,src:e.photoURL}),this.state.user.displayName),options:this.dropdownOptions()})))))}}]),t}(i.a.Component)),L=Object(w.b)((function(e){return{currentUser:e.user.currentUser}}))(A),T=a(43),I=a(88),F=a(546),x=a(543),D=function(e){return{type:"SET_CURRENT_CHANNEL",payload:{currentChannel:e}}},H=function(e){return{type:"SET_PRIVATE_CHANNEL",payload:{isPrivateChannel:e}}},z=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={user:a.props.currentUser,channel:{id:0,name:""},channels:[],channelName:"",channelDetails:"",channelsRef:N.database().ref("channels"),messagesRef:N.database().ref("messages"),notifications:[{id:0,total:0,lastKnownTotal:0,count:0}],isModalOpen:!1,firstLoad:!0,activeChannel:""},a.removeListeners=function(){a.state.channelsRef.off()},a.setFirstChannel=function(){var e=a.state.channels[0];a.state.firstLoad&&a.state.channels.length>0&&(a.props.setCurrentChannel(e),a.setActiveChannel(e)),a.setState({firstLoad:!1})},a.changeChannel=function(e){a.props.setCurrentChannel(e),a.clearNotifications(),a.setActiveChannel(e),a.props.setPrivateChannel(!1),a.setState({channel:e})},a.clearNotifications=function(){var e=a.state.notifications.findIndex((function(e){return e.id===a.state.channel.id}));if(-1!==e){var t=Object(I.a)(a.state.notifications);t[e].total=a.state.notifications[e].lastKnownTotal,t[e].count=0,a.setState({notifications:t})}},a.addNotificationListener=function(e){a.state.messagesRef.child(e).on("value",(function(t){a.state.channel&&a.handleNotifications(e,a.state.channel.id,a.state.notifications,t)}))},a.handleNotifications=function(e,t,n,r){var s=0,l=n.findIndex((function(t){return t.id===e}));-1!==l?(e!==t&&(s=n[l].total,r.numChildren()-s>0&&(n[l].count=r.numChildren()-s)),n[l].lastKnownTotal=r.numChildren()):n.push({id:e,total:r.numChildren(),lastKnownTotal:r.numChildren(),count:0}),a.setState({notifications:n})},a.setActiveChannel=function(e){return a.setState({activeChannel:e.id})},a.getNotificationCount=function(e){var t=0;if(a.state.notifications.forEach((function(a){a.id===e.id&&(t=a.count)})),t>0)return t},a.displayChannels=function(e){return e.length>0&&e.map((function(e){return i.a.createElement(p.a.Item,{key:e.id+e.name,onClick:function(){return a.changeChannel(e)},name:e.name,style:{opacity:.95},active:e.id===a.state.activeChannel},a.getNotificationCount(e)&&i.a.createElement(C.a,{color:"red"},a.getNotificationCount(e)),"# ",e.name)}))},a.addChannel=function(){var e=a.state,t=e.channelsRef,n=e.channelName,r=e.channelDetails,s=e.user;console.log("Firebase Database Ref: ",t);var l=t.push().key;console.log("USERNAME: ",s);var o={id:l,name:n,details:r,createdBy:{name:s.displayName,avatar:s.photoURL}};t.child(l).update(o).then((function(){a.setState({channelName:"",channelDetails:""}),a.closeModal(),console.log("channel added")})).catch((function(e){console.log("Catched Error:",e)}))},a.handleSubmit=function(e){e.preventDefault(),a.isFormValid(a.state)&&(a.addChannel(),console.log("channel added"))},a.openModal=function(){return a.setState({isModalOpen:!0})},a.closeModal=function(){return a.setState({isModalOpen:!1})},a.handleChange=function(e){a.setState(Object(T.a)({},e.currentTarget.name,e.currentTarget.value))},a.isFormValid=function(e){var t=e.channelName,a=e.channelDetails;return t&&a},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){this.addListenters(),console.log("CHANNELS -> State channels: ",this.state.channels)}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"addListenters",value:function(){var e=this,t=[];this.state.channelsRef.on("child_added",(function(a){t.push(a.val()),e.setState({channels:t},(function(){return e.setFirstChannel()})),e.addNotificationListener(a.key)}))}},{key:"render",value:function(){var e=this.state,t=e.channels,a=e.isModalOpen;return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a.Menu,{className:"menu"},i.a.createElement(p.a.Item,null,i.a.createElement("span",null,i.a.createElement(b.a,{name:"exchange"})," CHANNELS")," ","(",t.length,") ",i.a.createElement(b.a,{name:"add",onClick:this.openModal})),this.displayChannels(t)),i.a.createElement(v.a,{basic:!0,open:a,onClose:this.closeModal},i.a.createElement(v.a.Header,null,"Add a Channel"),i.a.createElement(v.a.Content,null,i.a.createElement(F.a,{onSubmit:this.handleSubmit},i.a.createElement(F.a.Field,null,i.a.createElement(x.a,{fluid:!0,label:"Name of Channel",name:"channelName",onChange:this.handleChange})),i.a.createElement(F.a.Field,null,i.a.createElement(x.a,{fluid:!0,label:"About the Channel",name:"channelDetails",onChange:this.handleChange})))),i.a.createElement(v.a.Actions,null,i.a.createElement(g.a,{color:"green",inverted:!0,onClick:this.handleSubmit},i.a.createElement(b.a,{name:"checkmark"})," Add"),i.a.createElement(g.a,{color:"red",inverted:!0,onClick:this.closeModal},i.a.createElement(b.a,{name:"remove"})," Cancel"))))}}]),t}(i.a.Component),B=Object(w.b)(null,{setCurrentChannel:D,setPrivateChannel:H})(z),W=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={activeChannel:"",user:a.props.currentUser,users:[],usersRef:N.database().ref("users"),connectedRef:N.database().ref(".info/connected"),presenceRef:N.database().ref("presence")},a.addListeners=function(e){var t=[];a.state.usersRef.on("child_added",(function(n){if(e!==n.key){var r=n.val();r.uid=n.key,r.status="offline",t.push(r),a.setState({users:t})}})),a.state.connectedRef.on("value",(function(t){if(!0===t.val()){var n=a.state.presenceRef.child(e);n.set(!0),n.onDisconnect().remove((function(e){}))}})),a.state.presenceRef.on("child_added",(function(t){e!==t.key&&a.addStatusToUser(t.key)})),a.state.presenceRef.on("child_removed",(function(t){e!==t.key&&a.addStatusToUser(t.key,!1)}))},a.addStatusToUser=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=a.state.users.reduce((function(a,n){return n.uid===e&&(n.status="".concat(t?"online":"offline")),a.concat(n)}),[]);a.setState({users:n})},a.isUserOnline=function(e){return"online"===e.status},a.changeChannel=function(e){var t={id:a.getChannelId(e.uid),name:e.name};a.props.setCurrentChannel(t),a.props.setPrivateChannel(!0),a.setActiveChannel(e.uid)},a.getChannelId=function(e){var t=a.state.user.uid;return e<t?"".concat(e,"/").concat(t):"".concat(t,"/").concat(e)},a.setActiveChannel=function(e){a.setState({activeChannel:e})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.state.user&&this.addListeners(this.state.user.uid)}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.activeChannel;return i.a.createElement(p.a.Menu,{className:"menu"},i.a.createElement(p.a.Item,null,i.a.createElement("span",null,i.a.createElement(b.a,{name:"mail"})," DIRECT MESSAGES")," ","(",a.length,")"),a.map((function(t){return i.a.createElement(p.a.Item,{key:t.uid,active:t.uid===n,onClick:function(){return e.changeChannel(t)},style:{opacity:.95,fontStyle:"italic"}},i.a.createElement(b.a,{name:"circle",color:e.isUserOnline(t)?"green":"red"}),"@ ",t.name)})))}}]),t}(j),V=Object(w.b)(null,{setCurrentChannel:D,setPrivateChannel:H})(W),q=a(55),G=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={starredChannels:[],activeChannel:{},openModal:!1,usersRef:N.database().ref("users"),user:a.props.currentUser},a.addListeners=function(e){a.state.usersRef.child(e).child("starred").on("child_added",(function(e){var t=Object(q.a)({id:e.key},e.val());a.setState({starredChannels:[].concat(Object(I.a)(a.state.starredChannels),[t])})})),a.state.usersRef.child(e).child("starred").on("child_removed",(function(e){var t=Object(q.a)({id:e.key},e.val()),n=a.state.starredChannels.filter((function(e){return e.id!==t.id}));a.setState({starredChannels:n})}))},a.setActiveChannel=function(e){return a.setState({activeChannel:e.id})},a.changeChannel=function(e){a.props.setCurrentChannel(e),a.setActiveChannel(e),a.props.setPrivateChannel(!0)},a.displayChannels=function(e){return e.length>0&&e.map((function(e){return i.a.createElement(p.a.Item,{key:e.id+e.name,onClick:function(){return a.changeChannel(e)},name:e.name,style:{opacity:.95},active:e.id===a.state.activeChannel},"# ",e.name)}))},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.state.user&&this.addListeners(this.state.user.uid)}},{key:"render",value:function(){var e=this.state.starredChannels;return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a.Menu,{className:"menu"},i.a.createElement(p.a.Item,null,i.a.createElement("span",null,i.a.createElement(b.a,{name:"star"})," STARRED")," ","(",e.length,") ",i.a.createElement(b.a,{name:"add",onClick:this.state.openModal})),this.displayChannels(e)))}}]),t}(j),K=Object(w.b)(null,{setCurrentChannel:D,setPrivateChannel:H})(G),J=a(275),X=a.n(J),Q=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.currentUser;return i.a.createElement(p.a,{id:X.a.slidePanelContainer,size:"large",inverted:!0,fixed:"left",vertical:!0},i.a.createElement(L,{currentUser:e}),i.a.createElement(K,{currentUser:e}),i.a.createElement(B,{currentUser:e}),i.a.createElement(V,{currentUser:e}))}}]),t}(j),$=a(286),Y=a(549),Z=a(551),ee=a(276),te=a.n(ee),ae=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={activeIndex:0,privateChannel:a.props.isPrivateChannel,currentChannel:a.props.currentChannel,userPosts:a.props.userPosts},a.formatCount=function(e){return"".concat(e,e>1||0===e?" posts":" post")},a.displayTopPosters=function(e){return Object.entries(e).sort((function(e,t){return t[1]-e[1]})).map((function(e,t){var n=Object($.a)(e,2),r=n[0],s=n[1];return i.a.createElement(Y.a.Item,{key:t},i.a.createElement(R.a,{avatar:!0,src:s.avatar}),i.a.createElement(Y.a.Content,null,i.a.createElement(Y.a.Header,{as:"a"},r),i.a.createElement(Y.a.Description,null,a.formatCount(s.count)," posts")))})).slice(0,5)},a.setActiveIndex=function(e,t){var n=t.index,r=a.state.activeIndex===n?-1:n;a.setState({activeIndex:r})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){console.log("private Channel boolean in componentDidMount: ",this.state.privateChannel),console.log("current Channel object in componentDidMount: ",this.state.currentChannel)}},{key:"render",value:function(){var e=this.state,t=e.activeIndex,a=e.privateChannel,n=e.currentChannel,r=this.props.userPosts;return!0===a?null:i.a.createElement(E.a,{loading:!n,id:te.a.metaPanel},i.a.createElement(U.a,{as:"h3",attached:"top"},"About",i.a.createElement("span",null," #",n&&n.name)),i.a.createElement(Z.a,{styled:!0,attached:"true"},i.a.createElement(Z.a.Title,{active:0===t,index:0,onClick:this.setActiveIndex},i.a.createElement(b.a,{name:"dropdown",color:"black"}),i.a.createElement(b.a,{name:"info",color:"black"}),"Channel Details"),i.a.createElement(Z.a.Content,{active:0===t},n&&n.details),i.a.createElement(Z.a.Title,{active:1===t,index:1,onClick:this.setActiveIndex},i.a.createElement(b.a,{name:"dropdown",color:"black"}),i.a.createElement(b.a,{name:"user circle",color:"black"}),"Top Posters"),i.a.createElement(Z.a.Content,{active:1===t},i.a.createElement(Y.a,null,r&&this.displayTopPosters(r),console.log("users post: ",r))),i.a.createElement(Z.a.Title,{active:2===t,index:2,onClick:this.setActiveIndex},i.a.createElement(b.a,{name:"dropdown",color:"black"}),i.a.createElement(b.a,{name:"pencil alternate",color:"black"}),"Created By"),i.a.createElement(Z.a.Content,{active:2===t},i.a.createElement(U.a,{as:"h3"},i.a.createElement(R.a,{circular:!0,src:n&&n.createdBy.avatar}),n&&n.createdBy.name))))}}]),t}(j),ne=a(548),re=a(277),se=a.n(re),le=a(544),oe=a(278),ce=a.n(oe),ie=function(e){var t=e.uploadState,a=e.percentUploaded;return"uploading"===t?i.a.createElement(le.a,{className:ce.a.progressBar,percent:a,progress:!0,indicating:!0,size:"medium",inverted:!0}):i.a.createElement(i.a.Fragment,null," ")},ue=a(281),de=a.n(ue),he=a(173),me=a.n(he),pe=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={file:null,authorized:["image/jpeg","image/png"]},a.addFile=function(e){var t=e.currentTarget.files;null!=t&&(a.setState({file:t[0]}),console.log("FileModal -> State FILES: ",t))},a.sendFile=function(){var e=a.state.file,t=a.props,n=t.uploadFile,r=t.closeModal;null!==e&&(a.isAuthorized(e.name)&&(n(e,{contentType:me.a.lookup(e.name)}),r(),a.clearFile()))},a.isAuthorized=function(e){return a.state.authorized.includes(me.a.lookup(e))},a.clearFile=function(){return a.setState({file:null})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.modal,a=e.closeModal;return i.a.createElement(v.a,{basic:!0,open:t,onClose:a},i.a.createElement(v.a.Header,null,"Select an Image Files"),i.a.createElement(v.a.Content,null,i.a.createElement(x.a,{onChange:this.addFile,fluid:!0,label:"File types: jpg, png",name:"file",type:"file"})),i.a.createElement(v.a.Actions,null,i.a.createElement(g.a,{color:"green",inverted:!0,onClick:this.sendFile},i.a.createElement(b.a,{name:"checkmark"})," Send"),i.a.createElement(g.a,{color:"red",inverted:!0,onClick:a},i.a.createElement(b.a,{name:"remove"})," Cancel")))}}]),t}(j),fe=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={storageRef:N.storage().ref(),uploadTask:null,uploadState:"",percentUploaded:0,message:"",channel:a.props.currentChannel,user:a.props.currentUser,loading:!1,errors:[{message:""}],modal:!1},a.openModal=function(){return a.setState({modal:!0})},a.closeModal=function(){return a.setState({modal:!1})},a.handleChange=function(e){a.setState(Object(T.a)({},e.currentTarget.name,e.currentTarget.value))},a.createMessage=function(e){var t;return t={timestamp:N.database.ServerValue.TIMESTAMP,user:{id:a.state.user.uid,name:a.state.user.displayName,avatar:a.state.user.photoURL},image:"",content:""},null!==e&&e?t.image=e:t.content=a.state.message,t},a.sendMessage=function(){var e=a.props.getMessagesRef,t=a.state,n=t.message,r=t.channel;n?(a.setState({loading:!0}),e().child(r.id).push().set(a.createMessage()).then((function(){a.setState({loading:!1,message:"",errors:[]})})).catch((function(e){console.error(e),a.setState({loading:!1,errors:a.state.errors.concat(e)})}))):a.setState({errors:a.state.errors.concat({message:"Add a message"})})},a.getPath=function(){return a.props.isPrivateChannel?"chat/private-".concat(a.state.channel.id):"chat/public"},a.uploadFile=function(e,t){var n=a.state.channel.id,r=a.props.messagesRef(),s="".concat(a.getPath(),"/").concat(se()(),".jpg");a.setState({uploadState:"uploading",uploadTask:a.state.storageRef.child(s).put(e,t)},(function(){a.state.uploadTask.on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);a.setState({percentUploaded:t})}),(function(e){console.log(e),a.setState({errors:a.state.errors.concat(e),uploadState:"error",uploadTask:null})}),(function(){a.state.uploadTask.snapshot.ref.getDownloadURL().then((function(e){a.sendFileMessage(e,r,n)})).catch((function(e){console.log(e),a.setState({errors:a.state.errors.concat(e),uploadState:"error",uploadTask:null})}))}))}))},a.sendFileMessage=function(e,t,n){t.child(n).push().set(a.createMessage(e)).then((function(){a.setState({uploadState:"done"})})).catch((function(e){console.error(e),a.setState({errors:a.state.errors.concat(e)})}))},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.errors,a=e.message,n=e.modal,r=e.loading,s=e.uploadState,l=e.percentUploaded;return i.a.createElement(E.a,{className:de.a.messageForm},i.a.createElement(x.a,{fluid:!0,name:"message",onChange:this.handleChange,value:a,style:{marginBottom:"0.7em"},label:i.a.createElement(g.a,{icon:"add"}),labelPosition:"left",placeholder:"Write your message",className:t.some((function(e){return e.message.includes("message")}))?"error":""}),i.a.createElement(g.a.Group,{icon:!0,widths:"1"},i.a.createElement(g.a,{onClick:this.sendMessage,disabled:r,color:"orange",content:"Add Replay",labelPosition:"left",icon:"edit"}),i.a.createElement(g.a,{color:"teal",disabled:"uploading"===s,onClick:this.openModal,content:"Upload Media",labelPosition:"right",icon:"cloud upload"})),i.a.createElement(pe,{modal:n,closeModal:this.closeModal,uploadFile:this.uploadFile}),i.a.createElement(ie,{uploadState:s,percentUploaded:l}))}}]),t}(j),ge=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.channelName,a=e.numUniqueUsers,n=e.handleSearchChange,r=e.searchLoading,s=e.isPrivateChannel,l=e.isChannelStarred,o=e.handleStar;return i.a.createElement(E.a,{clearing:!0},i.a.createElement(U.a,{fluid:"true",as:"h2",floated:"left",style:{marginBottom:0}},i.a.createElement("span",null,t,!s&&i.a.createElement(b.a,{onClick:o,name:l?"star":"star outline",color:l?"yellow":"black"})),i.a.createElement(U.a.Subheader,null,a)),i.a.createElement(U.a,null,i.a.createElement(x.a,{loading:r,onChange:n,size:"mini",icon:"search",name:"searchTerm",placeholder:"Search Messages"})))}}]),t}(j),ve=a(282),Ee=a.n(ve),Ce=function(e,t){return e.user.id===t.uid?"message__self":""},be=function(e){var t,a=e.message,n=e.user;return i.a.createElement(i.a.Fragment,null,i.a.createElement(ne.a,null,i.a.createElement(ne.a.Avatar,{src:a.user.avatar}),i.a.createElement(ne.a.Content,{className:Ce(a,n)},i.a.createElement(ne.a.Author,{as:"a"},a.user.name),i.a.createElement(ne.a.Metadata,null,(t=a.timestamp,Ee()(t).fromNow())),function(e){return""!==e.image&&""===e.content}(a)?i.a.createElement(R.a,{src:a.image,className:"message__image"}):i.a.createElement(ne.a.Text,null,a.content))))},ye=a(283),Se=a.n(ye),Oe=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={privateChannel:a.props.isPrivateChannel,privateMessagesRef:N.database().ref("privateMessages"),messagesRef:N.database().ref("messages"),messages:[],messagesLoading:!0,channel:a.props.currentChannel,user:a.props.currentUser,usersRef:N.database().ref("users"),numUniqueUsers:"",searchTerm:"",searchLoading:!1,searchResults:[],isChannelStarred:!1},a.addUserStarsListener=function(e,t){a.state.usersRef.child(t).child("starred").once("value").then((function(t){if(null!==t.val()){var n=Object.keys(t.val()).includes(e);a.setState({isChannelStarred:n})}}))},a.addListeners=function(e){return a.addMessageListener(e),e},a.addMessageListener=function(e){var t=[];a.getMessagesRef().child(e).on("child_added",(function(e){t.push(e.val()),a.setState({messages:t,messagesLoading:!1}),a.countUniqueUsers(t),a.countUserPosts(t)}))},a.getMessagesRef=function(){var e=a.state,t=e.messagesRef,n=e.privateMessagesRef;return e.privateChannel?n:t},a.handleStar=function(){a.setState((function(e){return{isChannelStarred:!e.isChannelStarred}}),(function(){return a.starChannel()}))},a.starChannel=function(){a.state.isChannelStarred?a.state.usersRef.child("".concat(a.state.user.uid,"/starred")).update(Object(T.a)({},a.state.channel.id,{name:a.state.channel.name,details:a.state.channel.details,createBy:{name:a.state.channel.createdBy.name,avatar:a.state.channel.createdBy.avatar}})):a.state.usersRef.child("".concat(a.state.user.uid,"/starred")).child(a.state.channel.id).remove((function(e){null!==e&&console.error(e)}))},a.handleSearchChange=function(e){a.setState({searchTerm:e.currentTarget.value,searchLoading:!0},(function(){return a.handleSearchMessages()}))},a.handleSearchMessages=function(){var e=Object(I.a)(a.state.messages),t=new RegExp(a.state.searchTerm,"gi"),n=e.reduce((function(e,a){return(a.content&&a.content.match(t)||a.user.name.match(t))&&e.push(a),e}),[]);a.setState({searchResults:n}),setTimeout((function(){return a.setState({searchLoading:!1})}),1e3)},a.countUniqueUsers=function(e){var t=e.reduce((function(e,t){return e.includes(t.user.name)||e.push(t.user.name),e}),[]),n=t.length>1||0===t.length,r="".concat(t.length," user").concat(n?"s":"");a.setState({numUniqueUsers:r})},a.countUserPosts=function(e){var t=e.reduce((function(e,t){return t.user.name in e?e[t.user.name].count+=1:e[t.user.name]={avatar:t.user.avatar,count:1},e}),{});console.log("userPosts -> Messages: ",t),a.props.setUserPosts(t)},a.displayMessages=function(e){return e.length>0&&e.map((function(e){return i.a.createElement(be,{key:e.timestamp,message:e,user:a.state.user})}))},a.displayChannelName=function(e){return e?"".concat(a.state.privateChannel?"@":"#").concat(e.name):""},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.state,t=e.channel,a=e.user;t&&a&&(this.addListeners(t.id),this.addUserStarsListener(t.id,a.uid))}},{key:"render",value:function(){var e=this.state,t=e.messagesRef,a=e.messages,n=e.channel,r=e.user,s=e.numUniqueUsers,l=e.searchTerm,o=e.searchResults,c=e.searchLoading,u=e.privateChannel,d=e.isChannelStarred;return i.a.createElement(i.a.Fragment,null,i.a.createElement(ge,{channelName:this.displayChannelName(n),numUniqueUsers:s,handleSearchChange:this.handleSearchChange,searchLoading:c,isPrivateChannel:u,handleStar:this.handleStar,isChannelStarred:d}),i.a.createElement(E.a,null,i.a.createElement(ne.a.Group,{style:{maxWidth:"98%"},className:Se.a.messages},l?this.displayMessages(o):this.displayMessages(a))),i.a.createElement(fe,{messagesRef:t,currentChannel:n,currentUser:r,isPrivateChannel:u,getMessagesRef:this.getMessagesRef}))}}]),t}(j),je=Object(w.b)(null,{setUserPosts:function(e){return{type:"SET_USER_POSTS",payload:{userPosts:e}}}})(Oe),ke=Object(w.b)((function(e){return{currentUser:e.user.currentUser,currentChannel:e.channel.currentChannel,isPrivateChannel:e.channel.isPrivateChannel,userPosts:e.user.userPosts}}))((function(e){var t=e.currentUser,a=e.currentChannel,n=e.isPrivateChannel,r=e.userPosts;return i.a.createElement(h.a,{columns:"equal"},i.a.createElement(k,{key:t&&t.name,currentUser:t}),i.a.createElement(Q,{key:t&&t.uid,currentUser:t}),i.a.createElement(h.a.Column,{style:{marginLeft:320}},i.a.createElement(je,{key:a&&a.id,currentChannel:a,currentUser:t,isPrivateChannel:n})),i.a.createElement(h.a.Column,{width:4},i.a.createElement(ae,{key:a&&a.name,currentChannel:a,userPosts:r,isPrivateChannel:n})))})),Ue=a(552),Me=a(87),Re=a(135),we=a.n(Re),_e=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={email:"",password:"",errors:[],loading:!1},a.displayErrors=function(e){return e.map((function(e,t){return i.a.createElement("p",{key:t},e.message)}))},a.handleChange=function(e){a.setState(Object(T.a)({},e.currentTarget.name,e.currentTarget.value))},a.handleSubmit=function(e){e.preventDefault(),a.isFormValid(a.state)&&(a.setState({errors:[],loading:!0}),O.a.auth().signInWithEmailAndPassword(a.state.email,a.state.password).then((function(e){console.log(e)})).catch((function(e){console.error(e),a.setState({errors:a.state.errors.concat(e),loading:!1})})))},a.isFormValid=function(e){return e.email&&e.password},a.handleInputError=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t)}))?"error":""},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,n=e.errors,r=e.loading;return i.a.createElement(h.a,{textAlign:"center",verticalAlign:"middle",className:we.a.register,"data-test":"register-component"},i.a.createElement(h.a.Column,{style:{maxWidth:450}},i.a.createElement(U.a,{as:"h1",icon:!0,color:"violet",textAlign:"center"},i.a.createElement("span",{className:we.a.loginHeader},"Login In Here")),i.a.createElement("form",{className:we.a.formContainer,onSubmit:this.handleSubmit},i.a.createElement("div",null,i.a.createElement("p",null,"DevChat")),i.a.createElement("input",{name:"email",placeholder:"Email Address",value:t,className:this.handleInputError(n,"email"),onChange:this.handleChange,type:"email"}),i.a.createElement("input",{name:"password",placeholder:"Password",value:a,className:this.handleInputError(n,"password"),onChange:this.handleChange,type:"password"}),i.a.createElement(g.a,{disabled:r,className:r?"loading":" ",color:"violet",fluid:!0,size:"large"},"Submit"),i.a.createElement("div",{className:"uiMessage"},"Don't have an account? "," ",i.a.createElement(Me.b,{to:"/register"}," Register"))),n.length>0&&i.a.createElement(Ue.a,{error:!0},i.a.createElement("h3",null,"Error"),this.displayErrors(n))))}}]),t}(j),Pe=a(136),Ne=a.n(Pe),Ae=a(285),Le=a.n(Ae),Te=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).state={username:"",email:"",password:"",passwordConfirmation:"",errors:[],loading:!1,usersRef:N.database().ref("users")},a.displayErrors=function(e){return e.map((function(e,t){return i.a.createElement("p",{key:t},e.message)}))},a.handleChange=function(e){a.setState(Object(T.a)({},e.currentTarget.name,e.currentTarget.value))},a.handleSubmit=function(e){e.preventDefault(),a.isFormValid()&&(a.setState({errors:[],loading:!0}),N.auth().createUserWithEmailAndPassword(a.state.email,a.state.password).then((function(e){console.log(e),e.user.updateProfile({displayName:a.state.username,photoURL:"http://gravatar.com/avatar/".concat(Le()(e.user.email),"?d=identicon")}).then((function(){a.saveUser(e).then((function(){console.log("user saved")}))})).catch((function(e){console.error(e),a.setState({errors:a.state.errors.concat(e),loading:!1})}))})).catch((function(e){console.error(e),a.setState({errors:a.state.errors.concat(e),loading:!1})})))},a.saveUser=function(e){return a.state.usersRef.child(e.user.uid).set({name:e.user.displayName,avatar:e.user.photoURL})},a.handleInputError=function(e,t){return e.some((function(e){return e.message.toLowerCase().includes(t)}))?"error":""},a.isFormValid=function(){var e,t=a.state.errors;return a.isFormEmpty(a.state)?(e={message:"Fill In All Fields"},a.setState({errors:t.concat(e)}),!1):!!a.isPasswordValid(a.state)||(e={message:"Password is invalid"},a.setState({errors:t.concat(e)}),!1)},a.isFormEmpty=function(e){return!e.username.length||!e.email.length||!e.password.length||!e.passwordConfirmation.length},a.isPasswordValid=function(e){var t=e.password,a=e.passwordConfirmation;return!(t.length<6||a.length<6)&&t===a},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,a=e.email,n=e.password,r=e.passwordConfirmation,s=e.errors,l=e.loading;return i.a.createElement(h.a,{textAlign:"center",verticalAlign:"middle",className:Ne.a.register,"data-test":"register-component"},i.a.createElement(h.a.Column,{style:{maxWidth:450}},i.a.createElement(U.a,{as:"h1",icon:!0,color:"orange",textAlign:"center"},i.a.createElement("span",{className:Ne.a.loginHeader},"Register With Us")),i.a.createElement("form",{"data-test":"form-component",onSubmit:this.handleSubmit,className:Ne.a.formContainer},i.a.createElement("div",null,i.a.createElement("p",null,"DevChat")),i.a.createElement("input",{"data-test":"username-input",name:"username",placeholder:"Username",value:t,onChange:this.handleChange,type:"text"}),i.a.createElement("input",{name:"email",placeholder:"Email Address",value:a,className:this.handleInputError(s,"email"),onChange:this.handleChange,type:"email"}),i.a.createElement("input",{name:"password",placeholder:"Password",value:n,className:this.handleInputError(s,"password"),onChange:this.handleChange,type:"password"}),i.a.createElement("input",{name:"passwordConfirmation",placeholder:"Password Confirmation",value:r,className:this.handleInputError(s,"password"),onChange:this.handleChange,type:"password"}),i.a.createElement(g.a,{"data-test":"component-submit-btn",disabled:l,className:l?"loading":" ",color:"orange",size:"large"},"Submit"),i.a.createElement("div",{className:"uiMessage"},"Already a user?",i.a.createElement(Me.b,{to:"/login"}," Login"))),s.length>0&&i.a.createElement(Ue.a,{error:!0},i.a.createElement("h3",null,"Error"),this.displayErrors(s))))}}]),t}(j),Ie=a(557),Fe=a(545),xe=function(){return i.a.createElement(Ie.a,{active:!0},i.a.createElement(Fe.a,{size:"huge",content:"Preparing Chat..."}))},De=a(176),He=a(65),ze={currentUser:null,isLoading:!0},Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return{currentUser:t.payload.currentUser,isLoading:!1};case"CLEAR_USER":return Object(q.a)({},ze,{isLoading:!1});case"SET_USER_POSTS":return Object(q.a)({},e,{userPosts:t.payload.userPosts});default:return e}},We={currentChannel:"",userPosts:null},Ve=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CHANNEL":return Object(q.a)({},e,{currentChannel:t.payload.currentChannel});case"SET_PRIVATE_CHANNEL":return Object(q.a)({},e,{isPrivateChannel:t.payload.isPrivateChannel});default:return e}},qe=Object(He.c)({user:Be,channel:Ve}),Ge=a(66);a.d(t,"composeEnhancers",(function(){return Ke})),a.d(t,"middlewares",(function(){return Je}));var Ke=window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||He.d,Je=[De.a],Xe=Object(He.e)(qe,Ke(Object(He.a)(De.a))),Qe=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;N.auth().onAuthStateChanged((function(t){t?(e.props.setUser(t),e.props.history.push("/")):(e.props.history.push("/login"),e.props.clearUser())}))}},{key:"render",value:function(){return this.props.isLoading?i.a.createElement(xe,null):i.a.createElement(Ge.c,null,i.a.createElement(Ge.a,{exact:!0,path:"/",component:ke}),i.a.createElement(Ge.a,{path:"/login",component:_e}),i.a.createElement(Ge.a,{path:"/register",component:Te}))}}]),t}(j),$e=Object(Ge.f)(Object(w.b)((function(e){return{isLoading:e.user.isLoading}}),{setUser:function(e){return{type:"SET_USER",payload:{currentUser:e}}},clearUser:function(){return{type:"CLEAR_USER"}}})(Qe));document.getElementById("root")&&d.a.render(i.a.createElement(w.a,{store:Xe},i.a.createElement(Me.a,null,i.a.createElement($e,null))),document.getElementById("root"));t.default=Qe;"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[296,1,2]]]);
//# sourceMappingURL=main.9f9c348b.chunk.js.map